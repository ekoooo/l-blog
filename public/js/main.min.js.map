{"version":3,"sources":["main.min.js"],"names":["$","fn","message","msg","dom","append","animate","opacity","top","duration","done","setTimeout","easing","remove","jQuery","on","e","preventDefault","scrollTop","this","href","split","offset","postId","attr","length","thiz","isUnlike","hasClass","ajax","type","url","success","data","code","item","find","vote","removeClass","addClass","text","Number","eq","dataType","initVote","sidebar","method","info","linksBox","i","links","label","friendsLinksBox","friends_links","toggleClass"],"mappings":"CAAA,SAAUA,GACNA,EAAEC,GAAGC,QAAU,SAASC,GACpB,IAAIC,EAAMJ,EAAE,yBAA2BG,EAAM,WAE7CH,EAAE,QAAQK,OAAOD,GAEjBA,EAAIE,SACAC,QAAS,EACTC,IAAK,QAELC,SAAU,IAEVC,KAAM,WACFC,WAAW,WACPP,EAAIE,SACAC,QAAS,EACTC,IAAK,MAELC,SAAU,IACVG,OAAQ,QACRF,KAAM,WACFN,EAAIS,aAGb,SAxBnB,CA4BGC,QAGHd,EAAE,WAKMA,EAAE,mBAAmBe,GAAG,QAAS,SAAUC,GACvCA,EAAEC,iBAEFjB,EAAE,cAAcM,SACZY,UAAWlB,EAAE,yBAA2BmB,KAAKC,KAAKC,MAAM,KAAK,GAAK,MAAMC,SAASd,IAAM,GAAK,OAE5FC,SAAU,IACVG,OAAQ,YAQpB,WACI,IAAIW,EAASvB,EAAE,aAAawB,KAAK,gBAEjCxB,EAAE,8BAA8Be,GAAG,QAAS,WACxC,GAAGf,EAAE,4BAA4ByB,OAC7BzB,IAAIE,QAAQ,eACV,CACF,IAAIwB,EAAOP,KACPQ,EAAW3B,EAAEmB,MAAMS,SAAS,UAEhC5B,EAAE6B,MACEC,KAAM,OACNC,KAAMJ,EAAW,gBAAkB,eAAiBJ,EACpDS,QAAS,SAAUC,GACf,GAAiB,MAAdA,EAAKC,KAAc,CAClB,IAAIC,EAAOnC,EAAE0B,GAAMU,KAAK,KACpBC,EAAOV,EAAW3B,EAAE,eAAiBA,EAAE,aAExC2B,EACCQ,EAAKG,YAAY,cAAcC,SAAS,+BAExCJ,EAAKG,YAAY,eAAeC,SAAS,gCAG7CF,EAAKG,KAAKC,OAAOJ,EAAKK,GAAG,GAAGF,QAAU,GAEtCxC,IAAIE,QAAQ,cAEZF,IAAIE,QAAQ+B,EAAK/B,UAGzByC,SAAU,YAoEtBC,GA1DA5C,EAAE,8CAA8CwB,KAAK,SAAU,UAO/DxB,EAAE,eAAee,GAAG,QAAS,WACzB,IAAI8B,EAAU7C,EAAE,YAEZ6C,EAAQrB,KAAK,cACbxB,EAAE6B,MACEiB,OAAQ,MACRf,IAAK,WACLY,SAAU,OACVX,QAAS,SAAUC,GACf,GAAiB,MAAdA,EAAKC,KAAc,CAClB,IAAIa,EAAOd,EAAKc,KAEhB/C,EAAE,mBAAmBwC,KAAKO,EAAc,SACxC/C,EAAE,mBAAmBwC,KAAKO,EAAc,SACxC/C,EAAE,wBAAwBwC,KAAKO,EAAe,UAC9C/C,EAAE,4BAA4BwC,KAAKO,EAAwB,mBAC3D/C,EAAE,uBAAuBwC,KAAKO,EAAmB,cAGjD,IAAI,IADAC,EAAWhD,EAAE,iBACTiD,EAAI,EAAGA,EAAIF,EAAKG,MAAMzB,OAAQwB,IAClCD,EAAS3C,OAAO,4BAA8B0C,EAAKG,MAAMD,GAAG7B,KAAO,KAAO2B,EAAKG,MAAMD,GAAGE,MAAQ,QAIhG,IADAC,EAAkBpD,EAAE,kBACxB,IAAQiD,EAAI,EAAGA,EAAIF,EAAKM,cAAc5B,OAAQwB,IAC1CG,EAAgB/C,OAAO,4BAA8B0C,EAAKM,cAAcJ,GAAG7B,KAAO,KAAO2B,EAAKM,cAAcJ,GAAGE,MAAQ,QAI3HN,EAAQrB,KAAK,YAAa,UAE1BxB,EAAEE,QAAQ+B,EAAK/B,YAO/BF,EAAE,QAAQsD,YAAY,kBAG1BtD,EAAE,+BAA+Be,GAAG,uBAAwB,SAAUC,GAClEhB,EAAEmB,MAAMK,KAAK,MAAkB,cAAXR,EAAEc,KAAuB,gBAAkB","file":"main.min.js","sourcesContent":["(function($) {\n    $.fn.message = function(msg) {\n        var dom = $('<span class=\"message\">' + msg + '</span>');\n        \n        $('body').append(dom);\n        \n        dom.animate({\n            opacity: 1,\n            top: '40%'\n        }, {\n            duration: 300,\n            // easing: 'swing',\n            done: function () {\n                setTimeout(function () {\n                    dom.animate({\n                        opacity: 0,\n                        top: '0'\n                    }, {\n                        duration: 500,\n                        easing: 'swing',\n                        done: function () {\n                            dom.remove();\n                        }\n                    });\n                }, 2000);\n            }\n        });\n    }\n})(jQuery);\n\n\n$(function () {\n    /**\n     * 文章页面 TOC 动画滚动\n     */\n    function initMarkdownTocAnimate() {\n        $('.markdown-toc a').on('click', function (e) {\n            e.preventDefault();\n        \n            $('html, body').animate({\n                scrollTop: $('.reference-link[name=\"' + this.href.split('#')[1] + '\"]').offset().top - 70 + 'px'\n            }, {\n                duration: 500,\n                easing: 'swing'\n            });\n        });\n    }\n    \n    /**\n     * 投票\n     */\n    function initVote() {\n        var postId = $('.post-box').attr('data-post-id');\n        \n        $('.post-vote .post-vote-item').on('click', function () {\n            if($('.post-vote-item i.active').length) {\n                $().message('您已投过票了！');\n            }else {\n                var thiz = this;\n                var isUnlike = $(this).hasClass('unlike');\n                \n                $.ajax({\n                    type: 'POST',\n                    url: (isUnlike ? '/post/unlike/' : '/post/like/') + postId,\n                    success: function (data) {\n                        if(data.code === 200) {\n                            var item = $(thiz).find('i');\n                            var vote = isUnlike ? $('.unlike-num') : $('.like-num');\n                            \n                            if(isUnlike) {\n                                item.removeClass('icon-emoji').addClass('pink active icon-emoji_fill');\n                            }else {\n                                item.removeClass('icon-praise').addClass('pink active icon-praise_fill');\n                            }\n                            \n                            vote.text(Number(vote.eq(0).text()) + 1);\n                            \n                            $().message('投票成功！');\n                        }else {\n                            $().message(data.message);\n                        }\n                    },\n                    dataType: 'json'\n                });\n            }\n        });\n    }\n    \n    /**\n     * markdown 链接在新窗口打开\n     */\n    function initMarkdownLinkTarget() {\n        $('.markdown-body a:not([class^=\"toc-level\"])').attr('target', '_blank');\n    }\n    \n    /**\n     * 初始化 sidebar\n     */\n    function initSidebar() {\n        $('.sidebar-op').on('click', function () {\n            var sidebar = $('.sidebar');\n            // 第一次初始化数据\n            if(!sidebar.attr('data-init')) {\n                $.ajax({\n                    method: 'GET',\n                    url: '/sidebar',\n                    dataType: 'json',\n                    success: function (data) {\n                        if(data.code === 200) {\n                            var info = data.info;\n                            \n                            $('.author-ch-name').text(info['ch_name']);\n                            $('.author-en-name').text(info['en_name']);\n                            $('.collection-post-num').text(info['post_num']);\n                            $('.collection-category-num').text(info['post_category_num']);\n                            $('.collection-tag-num').text(info['post_tag_num']);\n                            \n                            var linksBox = $('.author-links');\n                            for(var i = 0; i < info.links.length; i++) {\n                                linksBox.append('<a target=\"_blank\" href=\"' + info.links[i].href + '\">' + info.links[i].label + '</a>');\n                            }\n    \n                            var friendsLinksBox = $('.friends-links');\n                            for(var i = 0; i < info.friends_links.length; i++) {\n                                friendsLinksBox.append('<a target=\"_blank\" href=\"' + info.friends_links[i].href + '\">' + info.friends_links[i].label + '</a>');\n                            }\n                            \n                            // 加入标志\n                            sidebar.attr('data-init', '1');\n                        }else {\n                            $.message(data.message);\n                        }\n                    }\n                });\n            }\n            \n            \n            $('body').toggleClass('sidebar-open');\n        });\n        \n        $('.sidebar .author-avatar img').on('mouseover mouseleave', function (e) {\n            $(this).attr('src', e.type === 'mouseover' ? '/img/logo.gif' : '/img/logo_1.png');\n        });\n    }\n    \n    /**\n     * 初始化\n     */\n    function init() {\n        initMarkdownTocAnimate();\n        initVote();\n        initMarkdownLinkTarget();\n        initSidebar();\n    }\n    \n    init();\n});"]}